== Optimal control of unconstrained landings <sec-results-optcontrol>
Building on the picture of the landing dynamics discussed above, an optimal control strategy can be synthesised by considering only the decelerating portion of the landing from a given initial state. Any preceding accelerating trajectory may be used to arrive at this state. For example, a bird might dive or flap its wings to increase its speed before decelerating to land. It is useful again to consider simplified abstractions of the model considering only lift or drag, where the optimal control strategy can be determined from inspection.

If lift is neglected, there is no control over the flight path angle and the only way to control the deceleration is through drag. A vertical flight path and thus zero speed is only possible if beginning from an initial state with a vertical flight path (black trajectory in @fig-opt-control\A). For initial states with non-vertical flight paths, the flight path angle reduces until the terminal speed is reached (@fig-opt-control\A yellow, green, pink lines). Maximising $C_D$ maximises the deceleration (shifting the terminal speed boundary as far to the left in phase space) and thus is the optimal strategy.

With only lift included, only gravity can decelerate the system; the steeper the flight path, the greater deceleration. For a given $C_L$, there exists exactly one trajectory that reaches a vertical flight path at the same time the speed becomes zero (black trajectory in @fig-opt-control\B). While any $C_L > 0$ will be able to produce this trajectory, the initial speed required is smallest when $C_L$ is maximised. For any given initial state, flying at maximum $C_L$ will result in the smallest touchdown speed (e.g. yellow trajectory in @fig-opt-control\B) and thus maximising $C_L$ is the optimal strategy. For larger initial speeds, a vertical climb will be reached at non-zero speeds (@fig-opt-control\B blue trajectory), at which point $C_L$ can be set to zero to maintain the vertical climb until zero speed is reached (@fig-opt-control\B blue dashed line). To determine the control of the vertical climb additional constraints or optimisation objectives would need to be introduced (e.g. minimising time or distance flown).

The system with lift and drag included can be considered as an intermediate between these two extremes. Lift can produce steep flight paths followed by drag to maximise deceleration. However, flying at maximum $C_L$ is no longer optimal for reaching steep climbs. Increasing $C_L$ also increases $C_D$, which reduces speed and in turn limits the amount of lift produced and ultimately the climb angle. Instead, the optimal control strategy must balance the increase in flight path angle with premature decreases in speed. The change in flight path angle per decrease in speed can be expressed as:
$
  (dif gamma) / (dif nu) = dot(gamma) / dot(nu) = (C_L nu - cos gamma) / (-C_D nu^2 - sin gamma)
$ <eq-opt-control>
and the value of alpha which minimises this ratio therefore gives the largest increase in $gamma$ per decrease in $nu$. As we only consider decelerating trajectories ($-C_D nu^2 - sin gamma < 0$) the solution is well defined. In phase space this ratio represents the gradient of the trajectory, so minimising it causes trajectories to move as steeply as possible to the top left corner where speed is minimised.

Solving for the value of $alpha$ which maximises @eq-opt-control involves solving the following equation:
$
  (partial C_L) / (partial alpha) dot(nu) + (partial C_D) / (partial alpha) nu dot(gamma) = 0
$<eq-opt-control-alpha>
which here is done numerically (see @supp-mat-optcontrol). This expression for the control strategy can also be derived from the necessary conditions for optimality using Pontryagin's maximum principle @kirkOptimalControlTheory2004 (see @supp-mat-optcontrol for derivation and validation of the different methods). This control law is optimal regardless of the functional form of the aerodynamic model as it is expressed only in terms of its derivatives with respect to $alpha$.

When lift or drag are excluded, the solutions to @eq-opt-control-alpha reduce to the optimal control strategies postulated above. With $C_L = 0$, @eq-opt-control-alpha reduces to $(partial C_D) / (partial alpha) nu dot(gamma) = 0$ and the solution is given by maximising $C_D$. When $C_D = 0$, @eq-opt-control-alpha reduces to $(partial C_L) / (partial alpha) dot(nu) = 0$ and the solution is given by maximising $C_L$.

There again is exactly one trajectory which reaches a vertical climb and zero speed simultaneously, given by the black trajectory in @fig-opt-control\C. Starting at any state along this trajectory and following the optimal control strategy will result in zero touchdown speed. For higher initial speeds (blue trajectory @fig-opt-control\C), this control strategy achieves a vertical climb with a non-zero speed, at which time reducing the lift coefficient to zero maintains the vertical trajectory until zero speed is reached. For lower initial speeds (e.g. yellow trajectory @fig-opt-control\C) a vertical trajectory and zero speed cannot be reached, but maximising @eq-opt-control results in the steepest possible path and lowest touchdown speed for the given initial conditions.

The optimal strategy causes $alpha$ to change as the state of the system changes and as such the $nu_("stall")$ and $nu_("term")$ boundaries also change as the trajectory progresses (see #link("supp-mat")[Supplementary Material]). By varying $alpha$ the optimal strategy is able to minimise both $nu_("stall")$ and $nu_("term")$ (i.e. the trajectory crosses the $nu_("stall")$ boundary with $C_L = C_(L"max")$ and crosses the $nu_("term")$ boundary with $C_D = C_(D"max")$). This would not be possible with a constant control strategy. The optimal control strategy causes $alpha$ to increase up to $pi\/2$ ($90 thin "degrees"$), which is not common in flight (although birds do exhibit large angles of attack when landing @carruthersAutomaticAeroelasticDevices2007). However, at this point in the trajectory the speed is low and aerodynamic forces are minimal, so even substantial differences in $alpha$ will have minimal effect (see @supp-mat-rigidbody).

All of the system states could achieve a vertical flight path and zero speed by increasing the kinetic energy of the system, for example by flapping the wings or diving (see hypothetical pink trajectory in @fig-opt-control\C). The new state of the system is now able to follow the black trajectory and can touchdown with zero speed.

These results can be applied to physically representative scales of birds to gauge the nominal displacements during a landing manoeuvre. For a pigeon (_Columba livia_, mass $400 thin "g"$, wing area $0.03 thin "m"^2$ @bergMomentInertiaBird1995) to achieve zero touchdown speed using a fixed-wing control strategy from a horizontal flight path would require an initial speed of $36 thin"m" thin "s"^(-1)$ (more than double their typical cruise speed @pennycuickMechanicsBirdMigration1969). From these initial conditions and to land with zero speed (black trajectory in @fig-opt-control\C) would involve $60 thin "m"$ of horizontal displacement and $20 thin "m"$ of climb. Considering the topographic environments in which pigeons commonly commute (e.g. urban canyons), this is unfeasible in many circumstances. Assuming isometric scaling of avian anatomy @greenewaltFlightBirdsSignificant1975, distances will scale with $m^(1/3)$, making fixed-wing landings even more prohibitive for larger birds. This solution allows us to hypothesize that the use of wing flapping in avian landings is not simply to reduce touchdown speed, which can be done using a fixed wing, but is to reduce touchdown speed while limiting the spatial displacement of the landing trajectory. The steep flight paths may also interfere with the visual control required to land @leeVisualControlVelocity1993.

#figure(
  image("../figs/optcontrol.pdf"),
  // box(width: 100%, height: 150pt, fill: luma(240), stroke: 1pt + black),
  caption: [Phase and physical space trajectories for optimal control strategies of unconstrained landing, with touchdown speeds of 0 (blue), 0 (black), 0.1 (yellow), 0.3 (green), 0.5 (pink). The blue trajectory attains a vertical climb with non-zero speed and reduces $C_L$ to zero to maintain the flight path angle. The vertical climb is shown with the blue dashed line. Pink dotted line represents a hypothetical trajectory that begins from an initial state which can only achieve a touchdown speed of 0.5 (pink trajectory) but inputs kinetic energy to the system to move it to a state in phase space which can achieve a touchdown speed of 0 (black trajectory). (A) only includes drag, (B) only includes lift, (C) includes both lift and drag, (D) timeseries plots for the speed (left), flight path angle (middle), and angle of attack (right) for the full model including lift and drag (panel C). In (C) the white region indicates where the optimal control strategy is undefined ($dot(nu) >= 0$).
  ],
)<fig-opt-control>
